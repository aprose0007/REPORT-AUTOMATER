<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Capstone Report Generator</title>
    <meta name="description"
        content="Automated document formatter for Capstone Project reports - Full AI-powered project content generation">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <!-- Word file parsing library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
</head>

<body>
    <!-- Animated Background -->
    <div class="bg-grid"></div>
    <div class="bg-glow bg-glow-1"></div>
    <div class="bg-glow bg-glow-2"></div>
    <div class="bg-glow bg-glow-3"></div>

    <!-- Header -->
    <header id="main-header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                </div>
                <span>CRG</span>
            </div>
            <div class="header-badge">SIMATS Engineering</div>
        </div>
    </header>

    <!-- Main Container -->
    <main id="app-main">
        <!-- Hero Section -->
        <section class="hero" id="hero-section">
            <h1 class="hero-title">
                <span class="hero-accent">Capstone</span>
                <br>Report Generator
            </h1>
            <p class="hero-subtitle">
                Generate a complete, AI-powered capstone project report in seconds.
                Perfectly formatted front pages, dynamic content, and professional output.
            </p>
        </section>

        <!-- Form Section -->
        <section class="form-section" id="form-section">
            <form id="project-form" autocomplete="off">
                <!-- Step Indicator -->
                <div class="step-indicator" id="step-indicator">
                    <div class="step active" data-step="1">
                        <div class="step-number">1</div>
                        <span>Project Info</span>
                    </div>
                    <div class="step-line"></div>
                    <div class="step" data-step="2">
                        <div class="step-number">2</div>
                        <span>Students</span>
                    </div>
                    <div class="step-line"></div>
                    <div class="step" data-step="3">
                        <div class="step-number">3</div>
                        <span>Guide & Dates</span>
                    </div>
                </div>

                <!-- Step 1: Project Info -->
                <div class="form-step active" id="step-1">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" />
                                    <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" />
                                </svg>
                            </div>
                            <div>
                                <h2>Project Information</h2>
                                <p>Enter your capstone project details</p>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="project-title">Project Title <span class="required">*</span></label>
                            <input type="text" id="project-title"
                                placeholder="e.g., Brain Tumor Detection Using Deep Learning" required>
                            <span class="hint">Enter your project title — Description & Technologies will be
                                auto-generated by AI</span>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="course-code">Course Code <span class="required">*</span></label>
                                <input type="text" id="course-code" placeholder="e.g., CSA0708" required>
                            </div>
                            <div class="form-group">
                                <label for="course-name">Course Name <span class="required">*</span></label>
                                <input type="text" id="course-name"
                                    placeholder="e.g., Computer Networks and Web Connections" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="branch-name">Branch / Department <span class="required">*</span></label>
                            <input type="text" id="branch-name" placeholder="e.g., CSE (AIDS)" required>
                        </div>

                        <div class="form-group">
                            <label for="project-description">Project Description <span class="required">*</span></label>
                            <textarea id="project-description" rows="3"
                                placeholder="Enter detailed description. This field is mandatory." required></textarea>
                            <span class="hint">Strictly provide your own project description. Content will be generated
                                based on this and your project title.</span>
                        </div>

                        <div class="form-group" style="margin-bottom: 20px;">
                            <label for="reference-file">Reference Template for Structure (.docx)</label>
                            <input type="file" id="reference-file" accept=".docx"
                                style="padding: 10px; background: hsla(240, 10%, 10%, 0.3); border: 1px dashed hsla(240, 10%, 50%, 0.3); border-radius: 8px; color: #fff; width: 100%;">
                            <span class="hint">Upload a report ONLY to copy its Table of Contents structure. All content
                                will be 100% NEW and generated strictly for YOUR project title.</span>
                        </div>

                        <div class="form-actions">
                            <div></div>
                            <button type="button" class="btn btn-primary" onclick="goToStep(2)" id="btn-next-1">
                                Next Step
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <polyline points="9 18 15 12 9 6" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Students -->
                <div class="form-step" id="step-2">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                                    <circle cx="9" cy="7" r="4" />
                                    <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                                    <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                                </svg>
                            </div>
                            <div>
                                <h2>Student Details</h2>
                                <p>Add 1–4 students. Grammar auto-adjusts for single student.</p>
                            </div>
                        </div>

                        <div class="student-info-banner" id="grammar-banner">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <circle cx="12" cy="12" r="10" />
                                <path d="M12 16v-4" />
                                <path d="M12 8h.01" />
                            </svg>
                            <span>Single student detected — grammar will auto-switch to <strong>"I / my"</strong>
                                instead of "We / our"</span>
                        </div>

                        <!-- Student 1 -->
                        <div class="student-block" id="student-1-block">
                            <div class="student-label">
                                <span class="student-badge">1</span>
                                Student 1 <span class="required">*</span>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="student-1-name">Full Name</label>
                                    <input type="text" id="student-1-name" placeholder="e.g., John Doe" required>
                                </div>
                                <div class="form-group">
                                    <label for="student-1-reg">Registration No.</label>
                                    <input type="text" id="student-1-reg" placeholder="e.g., RA2211028010XXX" required>
                                </div>
                            </div>
                        </div>

                        <!-- Student 2 -->
                        <div class="student-block optional" id="student-2-block">
                            <div class="student-label">
                                <span class="student-badge">2</span>
                                Student 2 <span class="tag-optional">Optional</span>
                                <button type="button" class="btn-clear" onclick="clearStudent(2)"
                                    title="Remove Student 2">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <line x1="18" y1="6" x2="6" y2="18" />
                                        <line x1="6" y1="6" x2="18" y2="18" />
                                    </svg>
                                </button>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="student-2-name">Full Name</label>
                                    <input type="text" id="student-2-name" placeholder="e.g., Jane Smith">
                                </div>
                                <div class="form-group">
                                    <label for="student-2-reg">Registration No.</label>
                                    <input type="text" id="student-2-reg" placeholder="e.g., RA2211028010XXX">
                                </div>
                            </div>
                        </div>

                        <!-- Student 3 -->
                        <div class="student-block optional" id="student-3-block">
                            <div class="student-label">
                                <span class="student-badge">3</span>
                                Student 3 <span class="tag-optional">Optional</span>
                                <button type="button" class="btn-clear" onclick="clearStudent(3)"
                                    title="Remove Student 3">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <line x1="18" y1="6" x2="6" y2="18" />
                                        <line x1="6" y1="6" x2="18" y2="18" />
                                    </svg>
                                </button>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="student-3-name">Full Name</label>
                                    <input type="text" id="student-3-name" placeholder="e.g., Bob Wilson">
                                </div>
                                <div class="form-group">
                                    <label for="student-3-reg">Registration No.</label>
                                    <input type="text" id="student-3-reg" placeholder="e.g., RA2211028010XXX">
                                </div>
                            </div>
                        </div>

                        <!-- Student 4 -->
                        <div class="student-block optional" id="student-4-block">
                            <div class="student-label">
                                <span class="student-badge">4</span>
                                Student 4 <span class="tag-optional">Optional</span>
                                <button type="button" class="btn-clear" onclick="clearStudent(4)"
                                    title="Remove Student 4">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <line x1="18" y1="6" x2="6" y2="18" />
                                        <line x1="6" y1="6" x2="18" y2="18" />
                                    </svg>
                                </button>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="student-4-name">Full Name</label>
                                    <input type="text" id="student-4-name" placeholder="e.g., Alice Brown">
                                </div>
                                <div class="form-group">
                                    <label for="student-4-reg">Registration No.</label>
                                    <input type="text" id="student-4-reg" placeholder="e.g., RA2211028010XXX">
                                </div>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn btn-ghost" onclick="goToStep(1)">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <polyline points="15 18 9 12 15 6" />
                                </svg>
                                Back
                            </button>
                            <button type="button" class="btn btn-primary" onclick="goToStep(3)" id="btn-next-2">
                                Next Step
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <polyline points="9 18 15 12 9 6" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Guide & Dates -->
                <div class="form-step" id="step-3">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                                    <line x1="16" y1="2" x2="16" y2="6" />
                                    <line x1="8" y1="2" x2="8" y2="6" />
                                    <line x1="3" y1="10" x2="21" y2="10" />
                                </svg>
                            </div>
                            <div>
                                <h2>Guide & Dates</h2>
                                <p>Supervisor details and submission timeline</p>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="guide-name">Guide / Supervisor Name <span class="required">*</span></label>
                            <input type="text" id="guide-name" placeholder="e.g., Dr. A. Kumar" required>
                        </div>

                        <div class="form-group">
                            <label for="guide-designation">Guide Designation <span class="required">*</span></label>
                            <input type="text" id="guide-designation" placeholder="e.g., Associate Professor" required>
                        </div>

                        <div class="form-group">
                            <label for="program-director">Program Director Name <span class="required">*</span></label>
                            <input type="text" id="program-director" placeholder="e.g., Dr. B. Sharma" required>
                        </div>

                        <div class="form-group">
                            <label for="department-name">Department Full Name <span class="required">*</span></label>
                            <input type="text" id="department-name"
                                placeholder="e.g., Computer Science and Engineering (AI & DS)" required>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="submission-date">Submission Date <span class="required">*</span></label>
                                <input type="text" id="submission-date" placeholder="e.g., August 2025" required>
                            </div>
                            <div class="form-group">
                                <label for="viva-date">Viva Date <span class="required">*</span></label>
                                <input type="text" id="viva-date" placeholder="e.g., 20th August 2025" required>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn btn-ghost" onclick="goToStep(2)">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <polyline points="15 18 9 12 15 6" />
                                </svg>
                                Back
                            </button>
                            <button type="button" class="btn btn-generate" onclick="generateDocument()"
                                id="btn-generate">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                                    <polyline points="14 2 14 8 20 8" />
                                    <line x1="16" y1="13" x2="8" y2="13" />
                                    <line x1="16" y1="17" x2="8" y2="17" />
                                </svg>
                                Generate Document
                            </button>
                        </div>
                    </div>
                </div>
            </form>
        </section>

        <!-- Output Section -->
        <section class="output-section hidden" id="output-section">
            <div class="output-header">
                <h2>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
                        <polyline points="22 4 12 14.01 9 11.01" />
                    </svg>
                    Generated Front Pages
                </h2>
                <div class="output-actions">
                    <button class="btn btn-outline" onclick="copyAll()" id="btn-copy-all">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
                        </svg>
                        Copy All
                    </button>
                    <button class="btn btn-outline" onclick="downloadDocx()" id="btn-download">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                            <polyline points="7 10 12 15 17 10" />
                            <line x1="12" y1="15" x2="12" y2="3" />
                        </svg>
                        Download Full Report (.docx)
                    </button>
                    <button class="btn btn-ghost" onclick="editForm()" id="btn-edit">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
                        </svg>
                        Edit Details
                    </button>
                </div>
            </div>

            <!-- Full Report Info Banner -->
            <div class="report-info-banner" id="report-info-banner">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                </svg>
                <div>
                    <strong>Full 25-Page Report</strong> — The download button generates a complete capstone report
                    with:
                    Table of Contents, Abstract, Introduction, Literature Review, System Design,
                    Implementation, Testing & Results, Conclusion, References — all with automatic page numbers.
                </div>
            </div>

            <!-- Grammar Notification -->
            <div class="grammar-notification" id="grammar-notification">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
                    <polyline points="22 4 12 14.01 9 11.01" />
                </svg>
                <span id="grammar-notification-text"></span>
            </div>

            <!-- Title Page Output -->
            <div class="output-card" id="output-title-page">
                <div class="output-card-label">
                    <span class="output-badge">Page 1</span>
                    Title Page
                    <button class="btn-copy-section" onclick="copySection('title-page-content')"
                        title="Copy this section">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
                        </svg>
                    </button>
                </div>
                <div class="output-content" id="title-page-content"></div>
            </div>

            <!-- Declaration Output -->
            <div class="output-card" id="output-declaration">
                <div class="output-card-label">
                    <span class="output-badge">Page 2</span>
                    Declaration
                    <button class="btn-copy-section" onclick="copySection('declaration-content')"
                        title="Copy this section">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
                        </svg>
                    </button>
                </div>
                <div class="output-content" id="declaration-content"></div>
            </div>

            <!-- Certificate Output -->
            <div class="output-card" id="output-certificate">
                <div class="output-card-label">
                    <span class="output-badge">Page 3</span>
                    Bonafide Certificate
                    <button class="btn-copy-section" onclick="copySection('certificate-content')"
                        title="Copy this section">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
                        </svg>
                    </button>
                </div>
                <div class="output-content" id="certificate-content"></div>
            </div>

            <!-- Acknowledgement Output -->
            <div class="output-card" id="output-acknowledgement">
                <div class="output-card-label">
                    <span class="output-badge">Page 4</span>
                    Acknowledgement
                    <button class="btn-copy-section" onclick="copySection('acknowledgement-content')"
                        title="Copy this section">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
                        </svg>
                    </button>
                </div>
                <div class="output-content" id="acknowledgement-content"></div>
            </div>
        </section>
    </main>

    <!-- Toast Notification -->
    <div class="toast hidden" id="toast">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" />
            <polyline points="22 4 12 14.01 9 11.01" />
        </svg>
        <span id="toast-message">Copied to clipboard!</span>
    </div>

    <!-- Docx generation libraries -->
    <script src="https://unpkg.com/docx@9.0.2/build/index.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <script src="logo_data.js"></script>
    <script src="content_generator.js"></script>
    <script src="script.js"></script>
    <script src="docx_export.js"></script>
</body>

</html>